import random
print("""\033[31m
 _____                                                                                                                       _____ 
( ___ )                                                                                                                     ( ___ )
 |   |~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~|   | 
 |   |                                                                                                                       |   | 
 |   |                                                                                                                       |   | 
 |   |  █████   ███   █████ ██████████ █████         █████████     ███████    ██████   ██████ ██████████                     |   | 
 |   | ░░███   ░███  ░░███ ░░███░░░░░█░░███         ███░░░░░███  ███░░░░░███ ░░██████ ██████ ░░███░░░░░█                     |   | 
 |   |  ░███   ░███   ░███  ░███  █ ░  ░███        ███     ░░░  ███     ░░███ ░███░█████░███  ░███  █ ░                      |   | 
 |   |  ░███   ░███   ░███  ░██████    ░███       ░███         ░███      ░███ ░███░░███ ░███  ░██████                        |   | 
 |   |  ░░███  █████  ███   ░███░░█    ░███       ░███         ░███      ░███ ░███ ░░░  ░███  ░███░░█                        |   | 
 |   |   ░░░█████░█████░    ░███ ░   █ ░███      █░░███     ███░░███     ███  ░███      ░███  ░███ ░   █                     |   | 
 |   |     ░░███ ░░███      ██████████ ███████████ ░░█████████  ░░░███████░   █████     █████ ██████████                     |   | 
 |   |      ░░░   ░░░      ░░░░░░░░░░ ░░░░░░░░░░░   ░░░░░░░░░     ░░░░░░░    ░░░░░     ░░░░░ ░░░░░░░░░░                      |   | 
 |   |                                                                                                                       |   | 
 |   |                                                                                                                       |   | 
 |   |                                                                                                                       |   | 
 |   |  ███████████    ███████                                                                                               |   | 
 |   | ░█░░░███░░░█  ███░░░░░███                                                                                             |   | 
 |   | ░   ░███  ░  ███     ░░███                                                                                            |   | 
 |   |     ░███    ░███      ░███                                                                                            |   | 
 |   |     ░███    ░███      ░███                                                                                            |   | 
 |   |     ░███    ░░███     ███                                                                                             |   | 
 |   |     █████    ░░░███████░                                                                                              |   | 
 |   |    ░░░░░       ░░░░░░░                                                                                                |   | 
 |   |                                                                                                                       |   | 
 |   |                                                                                                                       |   | 
 |   |                                                                                                                       |   | 
 |   |  ██████████   █████  █████ ██████   █████   █████████  ██████████    ███████    ██████   █████                        |   | 
 |   | ░░███░░░░███ ░░███  ░░███ ░░██████ ░░███   ███░░░░░███░░███░░░░░█  ███░░░░░███ ░░██████ ░░███                         |   | 
 |   |  ░███   ░░███ ░███   ░███  ░███░███ ░███  ███     ░░░  ░███  █ ░  ███     ░░███ ░███░███ ░███                         |   | 
 |   |  ░███    ░███ ░███   ░███  ░███░░███░███ ░███          ░██████   ░███      ░███ ░███░░███░███                         |   | 
 |   |  ░███    ░███ ░███   ░███  ░███ ░░██████ ░███    █████ ░███░░█   ░███      ░███ ░███ ░░██████                         |   | 
 |   |  ░███    ███  ░███   ░███  ░███  ░░█████ ░░███  ░░███  ░███ ░   █░░███     ███  ░███  ░░█████                         |   | 
 |   |  ██████████   ░░████████   █████  ░░█████ ░░█████████  ██████████ ░░░███████░   █████  ░░█████                        |   | 
 |   | ░░░░░░░░░░     ░░░░░░░░   ░░░░░    ░░░░░   ░░░░░░░░░  ░░░░░░░░░░    ░░░░░░░    ░░░░░    ░░░░░                         |   | 
 |   |                                                                                                                       |   | 
 |   |                                                                                                                       |   | 
 |   |                                                                                                                       |   | 
 |   |    █████████   ██████████   █████   █████ ██████████ ██████   █████ ███████████ █████  █████ ███████████   ██████████ |   | 
 |   |   ███░░░░░███ ░░███░░░░███ ░░███   ░░███ ░░███░░░░░█░░██████ ░░███ ░█░░░███░░░█░░███  ░░███ ░░███░░░░░███ ░░███░░░░░█ |   | 
 |   |  ░███    ░███  ░███   ░░███ ░███    ░███  ░███  █ ░  ░███░███ ░███ ░   ░███  ░  ░███   ░███  ░███    ░███  ░███  █ ░  |   | 
 |   |  ░███████████  ░███    ░███ ░███    ░███  ░██████    ░███░░███░███     ░███     ░███   ░███  ░██████████   ░██████    |   | 
 |   |  ░███░░░░░███  ░███    ░███ ░░███   ███   ░███░░█    ░███ ░░██████     ░███     ░███   ░███  ░███░░░░░███  ░███░░█    |   | 
 |   |  ░███    ░███  ░███    ███   ░░░█████░    ░███ ░   █ ░███  ░░█████     ░███     ░███   ░███  ░███    ░███  ░███ ░   █ |   | 
 |   |  █████   █████ ██████████      ░░███      ██████████ █████  ░░█████    █████    ░░████████   █████   █████ ██████████ |   | 
 |   | ░░░░░   ░░░░░ ░░░░░░░░░░        ░░░      ░░░░░░░░░░ ░░░░░    ░░░░░    ░░░░░      ░░░░░░░░   ░░░░░   ░░░░░ ░░░░░░░░░░  |   | 
 |   |                                                                                                                       |   | 
 |   |                                                                                                                       |   | 
 |   |                                                                                                                       |   | 
 |   |    █████████    █████████   ██████   ██████ ██████████                                                                |   | 
 |   |   ███░░░░░███  ███░░░░░███ ░░██████ ██████ ░░███░░░░░█                                                                |   | 
 |   |  ███     ░░░  ░███    ░███  ░███░█████░███  ░███  █ ░                                                                 |   | 
 |   | ░███          ░███████████  ░███░░███ ░███  ░██████                                                                   |   | 
 |   | ░███    █████ ░███░░░░░███  ░███ ░░░  ░███  ░███░░█                                                                   |   | 
 |   | ░░███  ░░███  ░███    ░███  ░███      ░███  ░███ ░   █                                                                |   | 
 |   |  ░░█████████  █████   █████ █████     █████ ██████████                                                                |   | 
 |   |   ░░░░░░░░░  ░░░░░   ░░░░░ ░░░░░     ░░░░░ ░░░░░░░░░░                                                                 |   | 
 |   |                                                                                                                       |   | 
 |   |                                                                                                                       |   | 
 |   |                                                                                                                       |   | 
 |   |                                                                                                                       |   | 
 |   |                                                                                                                       |   | 
 |___|~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~|___| 
(_____)                                                                                                                     (_____)
   \033[0m """)
print("\n")
print("""
██╗  ██╗ ██████╗ ██╗    ██╗    ████████╗ ██████╗     ██████╗ ██╗      █████╗ ██╗   ██╗   
██║  ██║██╔═══██╗██║    ██║    ╚══██╔══╝██╔═══██╗    ██╔══██╗██║     ██╔══██╗╚██╗ ██╔╝██╗
███████║██║   ██║██║ █╗ ██║       ██║   ██║   ██║    ██████╔╝██║     ███████║ ╚████╔╝ ╚═╝
██╔══██║██║   ██║██║███╗██║       ██║   ██║   ██║    ██╔═══╝ ██║     ██╔══██║  ╚██╔╝  ██╗
██║  ██║╚██████╔╝╚███╔███╔╝       ██║   ╚██████╔╝    ██║     ███████╗██║  ██║   ██║   ╚═╝
╚═╝  ╚═╝ ╚═════╝  ╚══╝╚══╝        ╚═╝    ╚═════╝     ╚═╝     ╚══════╝╚═╝  ╚═╝   ╚═╝      
""")
print ("\n")
print("- Move with keys: W (up), A (left), S (down), D (right)")
print(" - Collect all treasures (T) ")
print(" - Fight enemies (E)  by answering questions")
print(" - Reach the exit (H)  only after collecting all treasures")
print(" - Walls (#)  block your path")
print(" - Player starts at (P)  ")
print("\nYour goal is to Escape the dungeon alive with all treasures!\n")
print("=" * 200)
input("Press ENTER to begin your adventure...")


wall = "\033[37m"
gold = "\033[33m"     
red = "\033[31m"      
cyan = "\033[36m"     
green = "\033[32m"  
reset = "\033[0m"    

dungeon_map = [
    "#####################################################",
    "##                                               H ##",
    "####    #######   ######  #######   #######  ########",
    "###       ###   T   ##       ###   T   ###    ### T #",
    "# ###        E ########   ########         #####  ##",
    "#####   ####     ######## #######    ###    #### E ##",
    "###      ##       ###     ####   ###### #######  ####",
    "######       #######  T ######    ####   ###  #######",
    "#####           ######    ######    ### ##       ####",
    "#####    ###   #####     #####    ####     ##########",
    "###   ###    # #### #        ###      ####    #######",
    "##         ##   ########  E    ## ####    E #   #####",
    "##   ## E ### T #####     ######  ####   ####    ####",
    "###  ########   #####  ######         T ########  ###",
    "##  T   #############  #########    ###########  T ##",
    "####         ########   ###########       ####  #####",
    "#######     #### #####    ######    ####    E  ######",
    "###                                              ####",
    "#####     #######    #########  ####  ###     #######",
    "###   E     #######  ######      ####  #### T  ######",
    "#####  ###      #### #### T ##############   ########",
    "####   ####### E ######### ###########     ##########",
    "##     ######## ######## E ######### E ##############",
    "##   ######### T         ###########   ### T ########",
    "## P   ######## #####################        ########",
    "#####################################################"
]

pr, pc = 25,3
row_index = 0
for row in dungeon_map:
    if "P" in row:
        pr = row_index
        pc = row.index("P")
        break
    row_index += 1

ps = 0
tt = sum(row.count("T") for row in dungeon_map)
tc = 0



while True:
    
    print("\033[H\033[J", end="")
    current_map = "\nDungeon Map:\n\n"
    for row in dungeon_map:
        colored_row = ""
        for ch in row:
            if ch == "#":
                colored_row += wall + "#" + reset
            elif ch == "T":
                colored_row += gold + "T" + reset
            elif ch == "E":
                colored_row += red + "E" + reset
            elif ch == "P":
                colored_row += cyan + "P" + reset
            elif ch == "H":
                colored_row += green + "H" + reset
            else:
                colored_row += ch
        current_map += colored_row + "\n"
    current_map += f"\n{green}Score:{reset} {ps} | {gold}Treasures:{reset} {tc}/{tt}\n"
        
    print(current_map)
    
    direction = input("Move (W/A/S/D): ").lower()
    if direction in ["w", "a", "s", "d"]:
        new_row, new_col = pr, pc
        if direction == "w": new_row -= 1
        elif direction == "s": new_row += 1
        elif direction == "a": new_col -= 1
        elif direction == "d": new_col += 1

        target = dungeon_map[new_row][new_col]

        if target == "#":
            print("""
  ***********************
  *   ITS A WALL !!!    *
  *   You can't pass.   *
  ***********************
""")
            input("Press Enter to continue...") 
            continue  

        elif target == "T":
            print("""
  ***********************
  *   TREASURE FOUND!   *
  *       +10 pts       *
  ***********************
""")
            ps += 10
            tc += 1
            input("Press Enter to continue...") 

        elif target == "E":
            print("""
  ***************************
  *      ENEMY APPEARED!    *
  *   Solve This to fight   *
  ***************************
""")
            while True:
                a = random.randint(1 , 10)
                b= random.randint(2, 15)
                ans = a*b
                print(" What is %d * %d ?" % (a, b), end=" ")
                answer = int(input())

                if answer == ans:
                    print("""
  ***********************
  *  CORRECT ANSWER !!! *
  *  ENEMY DEFEATED!!   *
  *       +20 pts       *
  ***********************
                    """)
                    ps += 20
                    input("Press Enter to continue...") 
                    break
                else:
                    print("""
  **************************
  *     GAME OVER!!        *
  *   HAHAHA YOU LOSER     *
  * CAN'T DEFEAT THE ENEMY *
  *                        *
  *   DON'T PLAY THE GAME  *
  *   NOT FOR CHILDRENS    *
  **************************
                    """)
                    break

        elif target == "H":
            if tc == tt:
                print("""
  ***********************
  *  CONGRATULATIONS!!  *
  *   YOU WIN THE GAME  *
  ***********************
""")
                break
            else:
                print("""
***********************
*     EXIT IS LOCKED   *
* Collect all treasure *
***********************
""")            
                input("Press Enter to continue...") 
                continue

        dungeon_map[pr] = dungeon_map[pr][:pc] + " " + dungeon_map[pr][pc+1:]
        pr, pc = new_row, new_col
        dungeon_map[pr] = dungeon_map[pr][:pc] + "P" + dungeon_map[pr][pc+1:]

    else:
        print(" Invalid move!")
